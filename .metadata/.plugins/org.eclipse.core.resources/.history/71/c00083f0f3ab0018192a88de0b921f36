<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<%-- <spring:url value="/resources/planTable/js/planTable.js" var="calJs" />
<spring:url value="/resources/planTable/css/planTable.css" var="calCss" /> --%>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"crossorigin="anonymous"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
<%-- <script src="${calJs}"></script>
<link href="${calCss}" rel="stylesheet" />  --%>
<script type="text/javascript">

$(document).ready(function() {
	function viewAllGo() {
		
		$.ajax({
			url : '/jamplan/moveViewAll.view',
			type : 'POST',
			dataType: "json",
			async: false,
	        contentType : 'application/x-www-form-urlencoded; charset=utf-8',
			success:function(data){
				$('#planput').empty();
				$('#saveput').empty();
				var put = '';
				var saveput = '';
					saveput += '<br><br>';
					saveput += '<a href="javascript:savePlanTable();"><button class="btn btn-primary pull-right" >저장</button></a>';
					$('#saveput').append(saveput);
					
				$.each(data, function(index, item){
					/* $('#planput').empty(); */
					
					var planput = '';
					planput += '<table class="table">';
					planput += '<thead>';
					planput += '<th>날짜 </th>';
					planput += '<th>장소</th>';
					planput += '<th>일정</th>';
					planput += '</thead>';
					planput += '<tbody>';
					planput += '<tr>';
					planput += '<td>' + item.planDate + '</td>';
					planput += '<td>' + item.placeName + '</td>';
					planput += '<td><textarea class="form-control" name="memo" id="memo' + index + '" placeholder="여행계획을 작성해보세요!" rows="5" cols="30" >'+ item.memo +'</textarea></td>';
					planput += '<td><input type="text" hidden="hidden" id="planSeq'+index+'" value="'+item.planSeq+'"></td>'
					planput += '</tr>';
					planput += '</tbody>';
					planput += '</table>';
					
//						memoList[index] = item.map;
					console.log("planput" + planput);
					$('#planput').append(planput);
				});
			},
			error:function() {
				alert('ajax통신실패!!!');
			}
		});
	}

});

// savePlanTable : 저장
function savePlanTable(){
	var memoCnt = $('[name="memo"]');
	var params = {};
	for(var i=0; i<memoCnt.length; i++){
		params = {"memo" : $('#memo'+ i).val(), "planSeq" : $('#planSeq'+ i).val()};
		console.log(params);
		$.ajax({
			url : '/jamplan/savePlanTable.plan',
			type : 'POST',
			async: false,
			dataType: "json",
			contentType : 'application/x-www-form-urlencoded; charset=utf-8',
			data : params,
			success:function(data) {
				
				/* $.each(data, function(index, item){
						$('#updateput').empty();
						var updateput = '';
						updateput += '<table class="table">';
						updateput += '<thead>';
						updateput += '<th>날짜 </th>';
						updateput += '<th>장소</th>';
						updateput += '<th>일정</th>';
						updateput += '</thead>';
						updateput += '<tbody>';
						updateput += '<tr>';
						updateput += '<td>' + item.calendar + '</td>';
						updateput += '<td>' + item.map + '</td>';
						updateput += '<td><textarea class="form-control" id="memo" placeholder="여행계획을 작성해보세요!" rows="5" cols="30" >'+ item.memo +'</textarea></td>';
						updateput += '</tr>';
						updateput += '</tbody>';
						updateput += '</table>';
						
						
						console.log("updateput" + updateput);
						$('#updateput').append(updateput);
						
					}); */
			},
			error:function() {
				alert('ajax통신실패!!!');
			}
		});
	}
	alert('저장성공!');
	
}


</script>
</head>
<body>
	test!!

	<!-- <div id="saveput">testtest</div>
	palnTable 뿌려주기   
	<br><br>
	<div class="container" id="planput"></div> -->
	
</body>
</html>