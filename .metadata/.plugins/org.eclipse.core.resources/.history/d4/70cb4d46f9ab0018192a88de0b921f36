package com.spring.jamplan.viewall;

import java.util.ArrayList;

import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.spring.jamplan.model.PlanTableVO;
import com.spring.jamplan.model.ViewAllVO;

@Controller
public class ViewController {

   
   @Autowired
   private ViewService viewService;
   
   //getViewAll
   @RequestMapping(value = "moveViewAll.view", method = RequestMethod.POST, produces="application/json;charset=utf-8")
   @ResponseBody
   public String insertViewAll(HttpSession session, PlanTableVO planTableVO, ViewAllVO viewAllVO) {
      System.out.println("?");
      /*session체크
      String id = (String)session.getAttribute("id");*/
      
      /*String no = (String)session.getAttribute("plnaNo");
      int planNo = Integer.parseInt(no);
      
      System.out.println("session플랜번호=" + planNo);*/
      
     /* session.setAttribute("no", "1");
      String no = (String)session.getAttribute("no");
      int planNo = Integer.parseInt(no);
      
      System.out.println("planNo확인=" + planNo);
      
      planTableVO.setPlanNo(planNo);
      viewAllVO.setPlanNo(planNo);*/
      
      
      
      
      System.out.println("pt1");
      ArrayList getViewList = viewService.insertViewAll(planTableVO, viewAllVO);
      System.out.println("pt2");
      
      String str = "";
      
      ObjectMapper mapper = new ObjectMapper();
      try {
         str = mapper.writeValueAsString(getViewList);
      }
      catch (Exception e)
      {
         System.out.println("firest() mapper :" + e.getMessage());
      }
      
      System.out.println("str:" + str);
      return str;
      
   }
   
 /*  //savePlanTable : 저장
   @RequestMapping(value = "savePlanTable.plan", method = RequestMethod.POST, produces="application/json;charset=utf-8")
   @ResponseBody
   public String savePlanTable (HttpSession session, PlanTableVO planTableVO) {
      System.out.println("memo의값  = " + planTableVO.getMemo());
      System.out.println("save1");
      
      session.setAttribute("no", "1");
      String no = (String)session.getAttribute("no");
      int planNo = Integer.parseInt(no);
      planTableVO.setPlanNo(planNo);
      
      ArrayList savePlanList = planService.savePlanTable(planTableVO);
      
      String str = "";
      
      ObjectMapper mapper = new ObjectMapper();
      try {
         str = mapper.writeValueAsString(savePlanList);
      }
      catch (Exception e)
      {
         System.out.println("firest() mapper :" + e.getMessage());
      }
      
      System.out.println("str:" + str);
      return str;
   
      
      
   }*/
   
   
   
}